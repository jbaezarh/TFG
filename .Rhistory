summary(datos)
summary(datos$orientacion)
?cut
orientacion = cut(datos$orientacion,
breaks = c(-Inf,-1,22.5,67.5,112.5,157.5,202.5,247.5,292.5,337.5,360),
labels = c("Plano","N","NE","E","SE","S","SW","W","NW","N"))
summary(orientacion)
summary(datos)
datos = datos |>
mutate(cut(datos$orientacion,
breaks = c(-Inf,-1,22.5,67.5,112.5,157.5,202.5,247.5,292.5,337.5,360),
labels = c("Plano","N","NE","E","SE","S","SW","W","NW","N")))
summary(datos)
datos = dataset |>
select(-c(YEAR,MM,DD))
datos = dataset |>
select(-c(YEAR,MM,DD))
Se trata de un objeto de clase `sf` y `data.frame`:
Variables:
- fire: Variable respuesta con dos clases. Indica si en esa observación hay un incendio (1) o no (0).
- date: Fecha de la observación
- T2M: Temperatura del a 2m. The average air (dry bulb) temperature at 2 meters above the surface of the earth.
- GWETTOP: Surface Soil Wetness. The percent of soil moisture a value of 0 indicates a completely water-free soil and a value of 1 indicates a completely saturated soil; where surface is the layer from the surface 0 cm to 5 cm below grade.
- RH2M : Humedad relativa a 2m.The ratio of actual partial pressure of water vapor to the partial pressure at saturation, expressed in percent.
- WD10M: Wind Direction at 10m. The average of the wind direction at 10 meters above the surface of the earth (º).
- WS10M: Wind Speed at 10m. The average of wind speed at 10 meters above the surface of the earth (m/s).
- PRECTOTCORR: Precipitation Corrected.  The bias corrected average of total precipitation at the surface of the earth in water mass (includes water content in snow) (mm/day).
- elevacion: Elevación sobre el nivel del mar (m).
- pendiente: Pendiente del terreno (º).
- orientacion: Orientación de la pendiente descendiente medida en sentido de las agujas del reloj (º). Las áreas planas que no tienen dirección de pendiente descendente tienen un valor de -1.
https://desktop.arcgis.com/es/arcmap/latest/tools/spatial-analyst-toolbox/how-aspect-works.htm
- curvatura: Curvatura de la superfie ()
- dist_carretera:
- dist_poblacion:
- dist_electr:
- dist_ferocarril
- enp: Espacio Natural Protegido. Su valor es 1 si la observación se encuentra dentro de un espacio natural protegido o 0 en caso contrario.
- cod_municipio: Código del municipio en el que está la observación.
- municipio: Nombre del municipio en en el que está la observación.
- poblacion: Número de habitantes del municipio en el que se encuentra la observación en ese año.
- uso_suelo: Clasificación del uso del suelo.
- dist_rios: Distancia al río más próximo (m).
- NDVI: Índice de vegetación de diferencia normalizada.
- geometry: Geometría de la simple feature. En este caso, coordenadas del punto.
```{r}
summary(datos)
summary(datos)
datos <- datos |>
mutate(fire = as.factor(fire),
enp = as.factor(enp),
uso_suelo = as.factor(uso_suelo))
datos = datos |>
mutate(orientacion = cut(orientacion,
breaks = c(-Inf,-1,22.5,67.5,112.5,157.5,202.5,247.5,292.5,337.5,360),
labels = c("Plano","N","NE","E","SE","S","SW","W","NW","N")))
summary(datos)
table(fire,orientacion)
table(datos$fire,datis$orientacion)
table(datos$fire,datos$orientacion)
summary(datos)
datos(is.na(datos$elevacion))
datos[is.na(datos$elevacion)]
datos[is.na(datos$elevacion),]
datos |> filter(is.na(elevacion))
summary(datos)
summary(dataset)
datos |> filter(is.na(pendiente))
datos |> filter(is.na(pendiente)) |> plot()
datos |> filter(is.na(pendiente)) |> st_geometry() |> plot()
# Poligono de Andalucia
Andalucia <- esp_get_ccaa(ccaa = "Andalucía")
library(mapSpain)
# Poligono de Andalucia
Andalucia <- esp_get_ccaa(ccaa = "Andalucía")
andalucia_proj <- st_transform(Andalucia,crs_reference)
# CRS de referencia
pend <- rast("data_raw/topograficas/pendiente.tif")
crs_reference = crs(pend)
# CRS de referencia
pend <- rast("data_raw/topograficas/pendiente.tif")
# Cargamos las librerías
library(terra)
# CRS de referencia
pend <- rast("data_raw/topograficas/pendiente.tif")
crs_reference = crs(pend)
rm(pend)
# Poligono de Andalucia
Andalucia <- esp_get_ccaa(ccaa = "Andalucía")
andalucia_proj <- st_transform(Andalucia,crs_reference)
plot(andalucia_proj,reset=F)
plot(andalucia_proj$geometry,reset=F)
plot(st_geometry(andalucia_proj),reset=F)
plot(st_geometry(andalucia_proj),reset=F)
datos |> filter(is.na(pendiente)) |> st_geometry() |> plot()
plot(st_geometry(andalucia_proj),reset=F)
datos |> filter(is.na(pendiente)) |> st_geometry() |> plot(add=T)
pend <- rast("data_raw/topograficas/pendiente.tif")
plot(pend,add=T)
summary(datos)
plot(st_geometry(andalucia_proj),reset=F)
datos |>
filter(is.na(pendiente)| is.na(orientacion) | is.na(curvatura)) |>
st_geometry() |>
plot(add=T)
datos |>
filter(is.na(pendiente)| is.na(orientacion) | is.na(curvatura)) |>
st_geometry() |>
plot(pch=16,col="red",add=T)
# Variables topográficas --------------------------------------------------
elev <- rast("data_raw/topograficas/elevacion.tif")
plot(elev,add=T)
datos |>
filter(is.na(pendiente)| is.na(orientacion) | is.na(curvatura)) |>
summarise( st_geometry() |>
plot(pch=16,col="red",add=T))
datos |>
filter(is.na(pendiente)| is.na(orientacion) | is.na(curvatura)) |>
st_geometry() |>
plot(pch=16,col="red",add=T)
plot(st_geometry(andalucia_proj),reset=F)
datos |>
filter(is.na(pendiente)| is.na(orientacion) | is.na(curvatura)) |>
st_geometry() |>
plot(pch=16,col="red",add=T)
datos |>
filter(is.na(pendiente)| is.na(orientacion) | is.na(curvatura)) |> count()
datos |> st_drop_geometry() |>
filter(is.na(pendiente)| is.na(orientacion) | is.na(curvatura)) |> count()
summary(datos)
datos |>
filter(!(is.na(pendiente)| is.na(orientacion) | is.na(curvatura)))
datos = datos |>
filter(!(is.na(pendiente)| is.na(orientacion) | is.na(curvatura)))
summary(datos)
datos |>
filter(is.na(poblacion)) |>
select(year(date))
datos |>
filter(is.na(poblacion)) |>
mutate(Año = year(date)) |>
select(municipio, Año)
datos |>
filter(is.na(poblacion)) |>
mutate(Año = year(date)) |>
select(Año)
filter(is.na(poblacion)) |>
mutate(Año = year(date)) |>
select(Año)
datos |>
st_drop_geometry() |>
filter(is.na(poblacion)) |>
mutate(Año = year(date)) |>
select(Año)
datos |>
st_drop_geometry() |>
filter(is.na(poblacion)) |>
mutate(Año = year(date)) |>
select(Año,municipio)
datos |>
st_drop_geometry() |>
filter(is.na(poblacion)) |>
mutate(Año = year(date)) |>
select(Año,municipio,cod_municipio)
datos |>
arrange(desc(poblacion))
pob = read_csv2("D:/usuario/Documents/Universidad/5º/TFG - organizado/data_raw/antropologicas/Población/poblacion_municipios.txt")
pop
pob
pob = read_csv2("D:/usuario/Documents/Universidad/5º/TFG - organizado/data_raw/antropologicas/Población/poblacion_municipios.txt")[,c(1:5)]
pob
datos |>
st_drop_geometry() |>
filter(is.na(poblacion)) |>
mutate(Año = year(date)) |>
select(Año,municipio,cod_municipio)
names(pob)
pob |> filter(CODIGO_INE3 == "18077")
datos |> filter(is.na(uso_suelo))
plot(st_geometry(andalucia_proj),reset=F)
datos |> filter(is.na(uso_suelo)) |> st_geometry() |> plot()
plot(st_geometry(andalucia_proj),reset=F)
datos |> filter(is.na(uso_suelo)) |> st_geometry() |> plot(pch=16,col="red",add=T)
plot(st_geometry(andalucia_proj),reset=F)
datos |> filter(is.na(uso_suelo)) |> st_geometry() |> plot(pch=16,col="red",add=T)
datos = datos |>
filter(!is.na(uso_suelo))
summary(datos)
datos |>
mutate(mes = month(date),
año = year(date)) |>
group_by(mes,año) |>
transmute(NDVI_medio = mean(NDVI,na.rm=T))
datos |>
mutate(mes = month(date),
año = year(date)) |>
group_by(año) |>
transmute(NDVI_medio = mean(NDVI,na.rm=T))
datos |>
mutate(mes = month(date),
año = year(date)) |>
group_by(año) |>
summarise(NDVI_medio = mean(NDVI,na.rm=T))
datos |>
st_drop_geometry() |>
mutate(mes = month(date),
año = year(date)) |>
group_by(mes,año) |>
summarise(NDVI_medio = mean(NDVI,na.rm=T))
?mean
datos |>
st_drop_geometry() |>
mutate(mes = month(date),
año = year(date)) |>
group_by(mes,año) |>
summarise(NDVI_medio = mean(na.omit(NDVI)))
datos |>
st_drop_geometry() |>
mutate(mes = month(date),
año = year(date)) |>
group_by(año,mes) |>
summarise(NDVI_medio = mean(na.omit(NDVI)))
NDVI_mes = datos |>
st_drop_geometry() |>
mutate(mes = month(date),
año = year(date)) |>
group_by(año,mes) |>
summarise(NDVI_mes = mean(na.omit(NDVI)))
View(NDVI_mes)
NDVI_mes |>
ggplot(aes(y=NDVI_mes))
NDVI_mes |>
ggplot(aes(y=NDVI_mes)) |>
geom_line()
NDVI_mes |>
ggplot(aes(y=NDVI_mes)) +
geom_line()
NDVI_mes |>
ggplot(aes(y=NDVI_mes)) +
geom_bar()
NDVI_mes = datos |>
st_drop_geometry() |>
mutate(mes = month(date),
año = year(date)) |>
group_by(año,mes) |>
summarise(NDVI_mes = mean(na.omit(NDVI))) |>
mutate(id = 1:n())
NDVI_mes
NDVI_mes |>
ggplot(aes(x=id,y=NDVI_mes)) +
geom_bar()
NDVI_mes |>
ggplot(aes(x=id,y=NDVI_mes))
summary(NDVI_mes)
NDVI_mes
print(n=100)
print(NDVI_mes,n=100)
NDVI_mes = datos |>
st_drop_geometry() |>
mutate(mes = month(date),
año = year(date)) |>
group_by(año,mes) |>
summarise(NDVI_mes = mean(na.omit(NDVI))) |>
ungroup() |>
mutate(id = 1:n())
print(NDVI_mes,n=100)
NDVI_mes |>
ggplot(aes(x=id,y=NDVI_mes))
NDVI_mes |>
ggplot(aes(x=id,y=NDVI_mes)) +
geom_bar()
NDVI_mes |>
ggplot(aes(x=id,y=NDVI_mes)) +
geom_point()
NDVI_mes |>
ggplot(aes(x=id,y=NDVI_mes)) +
geom_line()
?xlab
paste0(NDVI_mes$año,NDVI_mes$mes)
paste0(NDVI_mes$año,NDVI_mes$mes,collapse = "-")
paste0(NDVI_mes$año,NDVI_mes$mes,sep = "-")
paste(NDVI_mes$año,NDVI_mes$mes,sep = "-")
NDVI_mes |>
ggplot(aes(x=id,y=NDVI_mes)) +
geom_line()+
xlab(paste(NDVI_mes$año,NDVI_mes$mes,sep = "-"))
paste(15,NDVI_mes$mes,NDVI_mes$año)
paste(15,NDVI_mes$mes,NDVI_mes$año,sep="/")
paste(01,NDVI_mes$mes,NDVI_mes$año,sep="/")
NDVI_mes = datos |>
st_drop_geometry() |>
mutate(mes = month(date),
año = year(date)) |>
group_by(año,mes) |>
summarise(NDVI_mes = mean(na.omit(NDVI))) |>
ungroup() |>
mutate(date = dmy(paste(01,NDVI_mes$mes,NDVI_mes$año,sep="/")))
NDVI_mes = datos |>
st_drop_geometry() |>
mutate(mes = month(date),
año = year(date)) |>
group_by(año,mes) |>
summarise(NDVI_mes = mean(na.omit(NDVI))) |>
ungroup() |>
mutate(date = dmy(paste(01,mes,año,sep="/")))
NDVI_mes
NDVI_mes |>
ggplot(aes(x=date,y=NDVI_mes)) +
geom_line()+
scale_x_date()
NDVI_mes |>
ggplot(aes(x=date,y=NDVI_mes)) +
geom_line()+
scale_x_date(date_labels = "%b")
NDVI_mes |>
ggplot(aes(x=date,y=NDVI_mes)) +
geom_line()+
scale_x_date(date_breaks = "1 month",date_labels = "%b")
NDVI_mes |>
ggplot(aes(x=date,y=NDVI_mes)) +
geom_line()+
scale_x_date(date_breaks = "3 month",date_labels = "%b")
NDVI_mes |>
ggplot(aes(x=date,y=NDVI_mes)) +
geom_line()+
scale_x_date(date_breaks = "6 month",date_labels = "%b")
NDVI_mes |>
ggplot(aes(x=date,y=NDVI_mes)) +
geom_line()+
scale_x_date(date_breaks = "10 month",date_labels = "%b")
NDVI_mes |>
ggplot(aes(x=date,y=NDVI_mes)) +
geom_line()+
scale_x_date(date_breaks = "10 month",date_labels = "%b")+
theme(axis.text.x = element_text(angle = 90))
NDVI_mes |>
ggplot(aes(x=date,y=NDVI_mes)) +
geom_line()+
scale_x_date(date_breaks = "6 month",date_labels = "%b")+
theme(axis.text.x = element_text(angle = 90))
NDVI_mes |>
ggplot(aes(x=date,y=NDVI_mes)) +
geom_line()+
scale_x_date(date_breaks = "6 month",date_labels = "%y")+
theme(axis.text.x = element_text(angle = 90))
NDVI_mes |>
ggplot(aes(x=date,y=NDVI_mes)) +
geom_line()+
scale_x_date(date_breaks = "6 month",date_labels = "%b %y")+
theme(axis.text.x = element_text(angle = 90))
NDVI_mes |>
ggplot(aes(x=date,y=NDVI_mes)) +
geom_line()+
scale_x_date(date_breaks = "6 month",date_labels = "%y%b")+
theme(axis.text.x = element_text(angle = 90))
load("salidas_intermedias/dataset_completo2024-03-27.RData")
datos = dataset |>
select(-c(YEAR,MM,DD))
# Librerías:
library(tidyverse)
library(sf)
load("salidas_intermedias/dataset_completo2024-03-27.RData")
datos = dataset |>
select(-c(YEAR,MM,DD))
str(datos)
summary(datos)
summary(datos)
datos <- datos |>
mutate(fire = as.factor(fire),
enp = as.factor(enp),
uso_suelo = as.factor(uso_suelo))
datos = datos |>
mutate(orientacion = cut(orientacion,
breaks = c(-Inf,-1,22.5,67.5,112.5,157.5,202.5,247.5,292.5,337.5,360),
labels = c("Plano","N","NE","E","SE","S","SW","W","NW","N")))
summary(datos)
plot(st_geometry(andalucia_proj),reset=F)
Andalucia <- esp_get_ccaa(ccaa = "Andalucía")
library(mapSpain)
Andalucia <- esp_get_ccaa(ccaa = "Andalucía")
andalucia_proj <- st_transform(Andalucia,crs_reference)
andalucia_proj <- st_transform(Andalucia,st_crs(dataset))
plot(st_geometry(andalucia_proj),reset=F)
datos |>
filter(is.na(pendiente)| is.na(orientacion) | is.na(curvatura)) |>
st_geometry() |>
plot(pch=16,col="red",add=T)
datos |>
st_drop_geometry() |>
filter(is.na(pendiente)| is.na(orientacion) | is.na(curvatura)) |>
count() #53 observaciones NA
datos = datos |>
filter(!(is.na(pendiente)| is.na(orientacion) | is.na(curvatura)))
summary(datos)
datos |>
st_drop_geometry() |>
filter(is.na(poblacion)) |>
mutate(Año = year(date)) |>
select(Año,municipio,cod_municipio)
pob = read_csv2("D:/usuario/Documents/Universidad/5º/TFG - organizado/data_raw/antropologicas/Población/poblacion_municipios.txt")[,c(1:5)]
pob |> filter(CODIGO_INE3 == "18077")
plot(st_geometry(andalucia_proj),reset=F)
datos |> filter(is.na(uso_suelo)) |> st_geometry() |> plot(pch=16,col="red",add=T)
datos = datos |>
filter(!is.na(uso_suelo))
plot(st_geometry(andalucia_proj),reset=F)
datos |> filter(is.na(uso_suelo)) |> st_geometry() |> plot(pch=16,col="red",add=T)
datos = datos |>
filter(!is.na(uso_suelo))
NDVI_mes = datos |>
st_drop_geometry() |>
mutate(mes = month(date),
año = year(date)) |>
group_by(año,mes) |>
summarise(NDVI_mes = mean(na.omit(NDVI))) |>
ungroup() |>
mutate(date = dmy(paste(01,mes,año,sep="/")))
NDVI_mes |>
ggplot(aes(x=date,y=NDVI_mes)) +
geom_line()+
scale_x_date(date_breaks = "6 month",date_labels = "%y%b")+
theme(axis.text.x = element_text(angle = 90))
datos |> filter(year(date) %in% 2000:2001) |> count()
datos |> st_drop_geometry() |> filter(year(date) %in% 2000:2001) |> count()
datos |> filter(year(date) !%in% 2000:2001)
datos |> filter(year(date) !(%in% 2000:2001))
datos |> filter(year(date) not(%in% 2000:2001))
datos |> filter(year(date) (!(%in% 2000:2001)))
datos |> filter(!year(date) %in% 2000:2001)
library(magrittr)
datos <%%> filter(!year(date) %in% 2000:2001)
datos <%> filter(!year(date) %in% 2000:2001)
?magrittr
datos %<>% filter(!year(date) %in% 2000:2001)
# Librerías:
library(tidyverse)
library(sf)
library(mapSpain)
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
# Librerías:
library(tidyverse)
library(sf)
library(mapSpain)
# Chunk 2
load("salidas_intermedias/dataset_completo2024-03-27.RData")
datos = dataset |>
select(-c(YEAR,MM,DD))
# Chunk 3
str(datos)
# Chunk 4
summary(datos)
# Chunk 5
datos <- datos |>
mutate(fire = as.factor(fire),
enp = as.factor(enp),
uso_suelo = as.factor(uso_suelo))
# Chunk 6
datos = datos |>
mutate(orientacion = cut(orientacion,
breaks = c(-Inf,-1,22.5,67.5,112.5,157.5,202.5,247.5,292.5,337.5,360),
labels = c("Plano","N","NE","E","SE","S","SW","W","NW","N")))
# Chunk 7
summary(datos)
# Chunk 8
Andalucia <- esp_get_ccaa(ccaa = "Andalucía")
andalucia_proj <- st_transform(Andalucia,st_crs(dataset))
plot(st_geometry(andalucia_proj),reset=F)
datos |>
filter(is.na(pendiente)| is.na(orientacion) | is.na(curvatura)) |>
st_geometry() |>
plot(pch=16,col="red",add=T)
datos |>
st_drop_geometry() |>
filter(is.na(pendiente)| is.na(orientacion) | is.na(curvatura)) |>
count() #53 observaciones NA
# Chunk 9
datos = datos |>
filter(!(is.na(pendiente)| is.na(orientacion) | is.na(curvatura)))
summary(datos)
# Chunk 10
datos |>
st_drop_geometry() |>
filter(is.na(poblacion)) |>
mutate(Año = year(date)) |>
select(Año,municipio,cod_municipio)
# Chunk 11
pob = read_csv2("D:/usuario/Documents/Universidad/5º/TFG - organizado/data_raw/antropologicas/Población/poblacion_municipios.txt")[,c(1:5)]
pob |> filter(CODIGO_INE3 == "18077")
# Chunk 12
plot(st_geometry(andalucia_proj),reset=F)
datos |> filter(is.na(uso_suelo)) |> st_geometry() |> plot(pch=16,col="red",add=T)
datos = datos |>
filter(!is.na(uso_suelo))
# Chunk 13
NDVI_mes = datos |>
st_drop_geometry() |>
mutate(mes = month(date),
año = year(date)) |>
group_by(año,mes) |>
summarise(NDVI_mes = mean(na.omit(NDVI))) |>
ungroup() |>
mutate(date = dmy(paste(01,mes,año,sep="/")))
NDVI_mes |>
ggplot(aes(x=date,y=NDVI_mes)) +
geom_line()+
scale_x_date(date_breaks = "6 month",date_labels = "%y%b")+
theme(axis.text.x = element_text(angle = 90))
datos |>
st_drop_geometry() |>
filter(year(date) %in% 2000:2001) |>
count()
library(magrittr)
